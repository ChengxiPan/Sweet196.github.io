<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>


  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "d3842409"
    });
  daovoice('update');
  </script>

    <meta name="description" content="This Chapter contains normal ML Algorithms in CIS Lectures. The mnist dataset was selected for demonstration. It is worth noting that only 1000 samples were used for training and testing here, in orde">
<meta property="og:type" content="article">
<meta property="og:title" content="Mnist Dataset dealt with Common Machine Learning Algorithms and CNN model">
<meta property="og:url" content="http://example.com/2023/05/21/CIS%20ML%20notes/index.html">
<meta property="og:site_name" content="慢慢走比较快">
<meta property="og:description" content="This Chapter contains normal ML Algorithms in CIS Lectures. The mnist dataset was selected for demonstration. It is worth noting that only 1000 samples were used for training and testing here, in orde">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212314028.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212317886.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212320902.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212321585.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212326246.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212327127.png">
<meta property="article:published_time" content="2023-05-21T14:56:23.726Z">
<meta property="article:modified_time" content="2023-05-21T15:27:24.206Z">
<meta property="article:author" content="Sweet196">
<meta property="article:tag" content="ML">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212314028.png">


<link rel="canonical" href="http://example.com/2023/05/21/CIS%20ML%20notes/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2023/05/21/CIS%20ML%20notes/","path":"2023/05/21/CIS ML notes/","title":"Mnist Dataset dealt with Common Machine Learning Algorithms and CNN model"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Mnist Dataset dealt with Common Machine Learning Algorithms and CNN model | 慢慢走比较快</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="慢慢走比较快" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <a target="_blank" rel="noopener" href="https://github.com/Sweet196" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">慢慢走比较快</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="fa fa-archive          //归档 fa-fw"></i>归档<span class="badge">19</span></a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="fa fa-th           //分类 fa-fw"></i>分类<span class="badge">6</span></a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags                     //标签 fa-fw"></i>标签<span class="badge">7</span></a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="fa fa-user                   //关于 fa-fw"></i>关于</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#SVM-Support-Vector-Machine"><span class="nav-number">1.</span> <span class="nav-text">SVM: Support Vector Machine</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#KNN-K-Nearest-Neighbor"><span class="nav-number">2.</span> <span class="nav-text">KNN: K-Nearest Neighbor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DTC-Decision-Tree-Classifier"><span class="nav-number">3.</span> <span class="nav-text">DTC: Decision Tree Classifier</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RF-Random-Forest"><span class="nav-number">4.</span> <span class="nav-text">RF: Random Forest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CNN-Network"><span class="nav-number">5.</span> <span class="nav-text">CNN Network</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GBDT-Gradient-Boosting-Decision-Tree"><span class="nav-number">6.</span> <span class="nav-text">GBDT: Gradient Boosting Decision Tree</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#XGBoost"><span class="nav-number">6.1.</span> <span class="nav-text">XGBoost</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LightGBM"><span class="nav-number">6.2.</span> <span class="nav-text">LightGBM</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sweet196"
      src="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212059399.jpg">
  <p class="site-author-name" itemprop="name">Sweet196</p>
  <div class="site-description" itemprop="description">Leisurely walking is faster in the end.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives">
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Sweet196" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sweet196" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:p3051329030@gmail.com" title="E-Mail → mailto:p3051329030@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/SweetDezBaby" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;SweetDezBaby" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/21/CIS%20ML%20notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212059399.jpg">
      <meta itemprop="name" content="Sweet196">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="慢慢走比较快">
      <meta itemprop="description" content="Leisurely walking is faster in the end.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Mnist Dataset dealt with Common Machine Learning Algorithms and CNN model | 慢慢走比较快">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Mnist Dataset dealt with Common Machine Learning Algorithms and CNN model
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2023-05-21 22:56:23 / 修改时间：23:27:24" itemprop="dateCreated datePublished" datetime="2023-05-21T22:56:23+08:00">2023-05-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>This Chapter contains normal ML Algorithms in CIS Lectures. The mnist dataset was selected for demonstration. It is worth noting that only 1000 samples were used for training and testing here, in order to accelerate the demonstration process. If better performance is to be achieved, all training and testing data should be used.</p>
<p>Project Repository: <a target="_blank" rel="noopener" href="https://github.com/Sweet196/Basic-Mnist-Classification">Basic-Mnist-Classification</a></p>
<p><em>I will appreciate if you give my repository a star all follow my channel. Plzzzzzzzz!!!!</em></p>
<h3 id="SVM-Support-Vector-Machine"><a href="#SVM-Support-Vector-Machine" class="headerlink" title="SVM: Support Vector Machine"></a>SVM: Support Vector Machine</h3><p>Support Vector Machine (SVM) is a popular machine learning algorithm used for <strong>classification and regression analysis</strong>. The basic idea behind SVM is to find a hyperplane in a high-dimensional space that separates the different classes of data points as best as possible. In other words, SVM tries to find the <strong>boundary</strong> between two classes of data by maximizing the margin between them. This margin is the distance between the closest data points of each class to the separator or hyperplane.</p>
<p>SVM can also handle non-linearly separable datasets through a technique called <strong>kernel trick</strong>, which maps the input data into a higher-dimensional space where it becomes linearly separable. Some popular kernel functions include <strong>linear, polynomial, radial basis function (RBF), and sigmoid</strong>.</p>
<p>SVM has been widely used in various fields such as image recognition, text classification, bioinformatics, and finance due to its effectiveness in handling complex datasets and relatively good performance in comparison to other algorithms.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">y_train = y_train.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line">y_test = y_test.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line">svm = SVC(kernel=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line">svm.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = svm.predict(X_test)</span><br><span class="line"></span><br><span class="line">accuracy = svm.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy: &quot;</span>, accuracy)</span><br><span class="line"></span><br><span class="line">cm = confusion_matrix(y_test, y_pred)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">sns.heatmap(cm, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Confusion Matrix&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Predicted Label&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;True Label&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>Accuracy: 0.853</p>
<p><img src="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212314028.png" alt="image-20230521231407970" style="zoom: 67%;" /></p>
<h3 id="KNN-K-Nearest-Neighbor"><a href="#KNN-K-Nearest-Neighbor" class="headerlink" title="KNN: K-Nearest Neighbor"></a>KNN: K-Nearest Neighbor</h3><p>KNN (K-Nearest Neighbor) is one of the simplest machine learning algorithms, which can be used for <strong>classification and regression</strong>. It is a supervised learning algorithm. Its idea is that if <strong>most of the K most similar</strong> (i.e. closest) samples in the feature space belong to a certain category, then the sample also belongs to that category. That is to say, this method only <strong>determines the category of the sample to be divided based on the category of the nearest one or several samples</strong> in the classification decision.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">y_train = y_train.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line">y_test = y_test.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line">knn = KNeighborsClassifier(n_neighbors=<span class="number">5</span>)</span><br><span class="line">knn.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = knn.predict(X_test)</span><br><span class="line"></span><br><span class="line">accuracy = knn.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy: &quot;</span>, accuracy)</span><br><span class="line"></span><br><span class="line">cm = confusion_matrix(y_test, y_pred)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">sns.heatmap(cm, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Confusion Matrix&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Predicted Label&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;True Label&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Accuracy: 0.815</p>
<p><img src="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212317886.png" alt="image-20230521231703633" style="zoom:67%;" /></p>
<h3 id="DTC-Decision-Tree-Classifier"><a href="#DTC-Decision-Tree-Classifier" class="headerlink" title="DTC: Decision Tree Classifier"></a>DTC: Decision Tree Classifier</h3><p><strong>Decision tree learning</strong> is a supervised learning approach used in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Statistics">statistics</a>, <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Data_mining">data mining</a> and <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Machine_learning">machine learning</a>. In this formalism, a classification or regression <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Decision_tree">decision tree</a> is used as a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Predictive_model">predictive model</a> to draw conclusions about a set of observations.</p>
<p>Tree models where the target variable can take a discrete set of values are called <strong><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Statistical_classification">classification</a> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Decision_tree">trees</a></strong>; in these tree structures, <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Leaf_node">leaves</a> represent class labels and branches represent <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Logical_conjunction">conjunctions</a> of features that lead to those class labels. Decision trees where the target variable can take continuous values (typically <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Real_numbers">real numbers</a>) are called <strong><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Regression_analysis">regression</a> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Decision_tree">trees</a></strong>. More generally, the concept of regression tree can be extended to any kind of object equipped with pairwise dissimilarities such as categorical sequences.<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Decision_tree_learning#cite_note-:1-1">[1]</a></p>
<p>Decision trees are among the most popular machine learning algorithms given their intelligibility and simplicity.<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Decision_tree_learning#cite_note-2">[2]</a></p>
<p>In decision analysis, a decision tree can be used to visually and explicitly represent decisions and <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Decision_making">decision making</a>. In <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Data_mining">data mining</a>, a decision tree describes data (but the resulting classification tree can be an input for <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Decision_making">decision making</a>).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">y_train = y_train.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line">y_test = y_test.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line">dtc = DecisionTreeClassifier(max_depth=<span class="number">10</span>)</span><br><span class="line">dtc.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = dtc.predict(X_test)</span><br><span class="line"></span><br><span class="line">accuracy = dtc.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy: &quot;</span>, accuracy)</span><br><span class="line"></span><br><span class="line">cm = confusion_matrix(y_test, y_pred)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">sns.heatmap(cm, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Confusion Matrix&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Predicted Label&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;True Label&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Accuracy: 0.646</p>
<h3 id="RF-Random-Forest"><a href="#RF-Random-Forest" class="headerlink" title="RF: Random Forest"></a>RF: Random Forest</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">y_train = y_train.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line">y_test = y_test.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line">rfc = RandomForestClassifier(n_estimators=<span class="number">100</span>, max_depth=<span class="number">10</span>)</span><br><span class="line">rfc.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = rfc.predict(X_test)</span><br><span class="line"></span><br><span class="line">accuracy = rfc.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy: &quot;</span>, accuracy)</span><br><span class="line"></span><br><span class="line">cm = confusion_matrix(y_test, y_pred)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">sns.heatmap(cm, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Confusion Matrix&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Predicted Label&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;True Label&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Accuracy: 0.862</p>
<p><img src="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212320902.png" alt="image-20230521232030222" style="zoom:67%;" /></p>
<h3 id="CNN-Network"><a href="#CNN-Network" class="headerlink" title="CNN Network"></a>CNN Network</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))[:<span class="number">1000</span>]</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))[:<span class="number">1000</span>]</span><br><span class="line">y_train = y_train.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line">y_test = y_test.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line">X_train = X_train / <span class="number">255.0</span></span><br><span class="line">X_test = X_test / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">model = tf.keras.Sequential([</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>, input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)),</span><br><span class="line">    tf.keras.layers.MaxPooling2D((<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPooling2D((<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.Flatten(),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">64</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">10</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=<span class="literal">True</span>),</span><br><span class="line">              metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">history = model.fit(X_train, y_train, epochs=<span class="number">50</span>, validation_data=(X_test, y_test))</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">12</span>, <span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制 Loss 图像</span></span><br><span class="line">ax[<span class="number">0</span>].plot(history.history[<span class="string">&#x27;loss&#x27;</span>], label=<span class="string">&#x27;Training Loss&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].plot(history.history[<span class="string">&#x27;val_loss&#x27;</span>], label=<span class="string">&#x27;Validation Loss&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_title(<span class="string">&#x27;Loss During Training&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_xlabel(<span class="string">&#x27;Epoch&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].set_ylabel(<span class="string">&#x27;Loss&#x27;</span>)</span><br><span class="line">ax[<span class="number">0</span>].legend()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制 Accuracy 图像</span></span><br><span class="line">ax[<span class="number">1</span>].plot(history.history[<span class="string">&#x27;accuracy&#x27;</span>], label=<span class="string">&#x27;Training Accuracy&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].plot(history.history[<span class="string">&#x27;val_accuracy&#x27;</span>], label=<span class="string">&#x27;Validation Accuracy&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_title(<span class="string">&#x27;Accuracy During Training&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_xlabel(<span class="string">&#x27;Epoch&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].set_ylabel(<span class="string">&#x27;Accuracy&#x27;</span>)</span><br><span class="line">ax[<span class="number">1</span>].legend()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212321585.png" alt="image-20230521232109490" style="zoom:67%;" /></p>
<h3 id="GBDT-Gradient-Boosting-Decision-Tree"><a href="#GBDT-Gradient-Boosting-Decision-Tree" class="headerlink" title="GBDT: Gradient Boosting Decision Tree"></a>GBDT: Gradient Boosting Decision Tree</h3><p>Classic gradient lifting tree: XGBoost and LightGBM. Some differences between them:</p>
<ul>
<li>Computational efficiency: LightGBM uses a histogram like technique when constructing decision trees, which can quickly find the optimal splitting point. Therefore, when training large datasets, LightGBM is usually faster than XGBoost.</li>
<li>Memory usage: LightGBM uses column based storage to reduce memory usage. This makes LightGBM more suitable for processing large high-dimensional data.</li>
<li>Regularization: XGBoost supports regularization technology to avoid overfitting, such as L1 and L2 regularization, feature importance ranking, etc. LightGBM only supports L2 regularization.</li>
<li>Distributed computing: XGBoost has built-in distributed computing capabilities, which can train models in parallel on multiple nodes. LightGBM currently does not support distributed computing.</li>
<li>Data sampling method: XGBoost adopts an instance based sampling method, which randomly selects a subset as the training set for each decision tree. LightGBM adopts a feature based sampling method, which samples features to select subsets.</li>
</ul>
<p>Overall, XGBoost and LightGBM perform well in practice, with the main difference being their design philosophy and implementation details. When choosing an algorithm, it should be based on the characteristics of the specific problem. If you need to process large-scale high-dimensional data, you can consider using LightGBM; If you need regularization or distributed computing, you can consider using XGBoost.</p>
<h4 id="XGBoost"><a href="#XGBoost" class="headerlink" title="XGBoost"></a>XGBoost</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, confusion_matrix</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reshape the data for training and testing</span></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">y_train = y_train.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line">y_test = y_test.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create DMatrix objects from the data</span></span><br><span class="line">dtrain = xgb.DMatrix(X_train, label=y_train)</span><br><span class="line">dtest = xgb.DMatrix(X_test, label=y_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the hyperparameters for the XGBoost model</span></span><br><span class="line">param = &#123;</span><br><span class="line">    <span class="string">&#x27;max_depth&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;eta&#x27;</span>: <span class="number">0.1</span>,</span><br><span class="line">    <span class="string">&#x27;objective&#x27;</span>: <span class="string">&#x27;multi:softmax&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;num_class&#x27;</span>: <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train the XGBoost model</span></span><br><span class="line">num_rounds = <span class="number">50</span></span><br><span class="line">bst = xgb.train(param, dtrain, num_rounds)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict the labels for the test set</span></span><br><span class="line">preds = bst.predict(dtest)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate the accuracy of the classifier</span></span><br><span class="line">acc = accuracy_score(y_test, preds)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy: &#123;:.2f&#125;%&quot;</span>.<span class="built_in">format</span>(acc * <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot the confusion matrix</span></span><br><span class="line">cm = confusion_matrix(y_test, preds)</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">sns.heatmap(cm, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Confusion Matrix&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Predicted Label&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;True Label&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>Accuracy: 82.60%</p>
<p><img src="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212326246.png" alt="image-20230521232601907" style="zoom:67%;" /></p>
<h4 id="LightGBM"><a href="#LightGBM" class="headerlink" title="LightGBM"></a>LightGBM</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lightgbm <span class="keyword">as</span> lgb</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, confusion_matrix</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reshape the data for training and testing</span></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>*<span class="number">28</span>))[:<span class="number">1000</span>]</span><br><span class="line">y_train = y_train.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line">y_test = y_test.astype(<span class="built_in">int</span>)[:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create Dataset objects from the data</span></span><br><span class="line">train_data = lgb.Dataset(X_train, label=y_train)</span><br><span class="line">test_data = lgb.Dataset(X_test, label=y_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the hyperparameters for the LightGBM model</span></span><br><span class="line">param = &#123;</span><br><span class="line">    <span class="string">&#x27;max_depth&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;learning_rate&#x27;</span>: <span class="number">0.1</span>,</span><br><span class="line">    <span class="string">&#x27;objective&#x27;</span>: <span class="string">&#x27;multiclass&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;num_class&#x27;</span>: <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train the LightGBM model</span></span><br><span class="line">num_rounds = <span class="number">50</span></span><br><span class="line">bst = lgb.train(param, train_data, num_rounds)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict the labels for the test set</span></span><br><span class="line">preds = bst.predict(X_test)</span><br><span class="line">preds = np.argmax(preds, axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate the accuracy of the classifier</span></span><br><span class="line">acc = accuracy_score(y_test, preds)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy: &#123;:.2f&#125;%&quot;</span>.<span class="built_in">format</span>(acc * <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot the confusion matrix</span></span><br><span class="line">cm = confusion_matrix(y_test, preds)</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">sns.heatmap(cm, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Confusion Matrix&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Predicted Label&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;True Label&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>Accuracy: 82.90%</p>
<p><img src="https://raw.githubusercontent.com/Sweet196/Picgo-images/main/problems/202305212327127.png" alt="image-20230521232707306" style="zoom:67%;" /></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/ML/" rel="tag"># ML</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/05/20/Python%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/" rel="prev" title="Python虚拟环境的创建与使用">
                  <i class="fa fa-chevron-left"></i> Python虚拟环境的创建与使用
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/06/17/BJC/" rel="next" title="BJC -- A Buct Java Compiler">
                  BJC -- A Buct Java Compiler <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sweet196</span>
</div>
  <!--
    <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>
  -->

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/fancybox.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"mhchem":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>




  
  <script type="text/javascript"
  color="0,0,255" opacity='0.45' zIndex="-2" count="90" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"live2d-widget-model-wanko"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"tagMode":false});</script></body>
</html>
